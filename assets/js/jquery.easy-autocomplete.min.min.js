var EasyAutocomplete=(function(c){c.Configuration=function d(a){var o={data:"list-required",url:"list-required",dataType:"json",listLocation:function(e){return e},xmlElementName:"",getValue:function(e){return e},autocompleteOff:true,placeholder:false,ajaxCallback:function(){},matchResponseProperty:false,list:{sort:{enabled:false,method:function(e,f){e=o.getValue(e);f=o.getValue(f);if(e<f){return -1}if(e>f){return 1}return 0}},maxNumberOfElements:6,hideOnEmptyPhrase:true,match:{enabled:false,caseSensitive:false,method:function(e,f){if(e.search(f)>-1){return true}else{return false}}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}},onClickEvent:function(){},onSelectItemEvent:function(){},onLoadEvent:function(){},onChooseEvent:function(){},onKeyEnterEvent:function(){},onMouseOverEvent:function(){},onMouseOutEvent:function(){},onShowListEvent:function(){},onHideListEvent:function(){}},highlightPhrase:true,theme:"",cssClasses:"",minCharNumber:0,requestDelay:0,adjustWidth:true,ajaxSettings:{},preparePostData:function(e,f){return e},loggerEnabled:true,template:"",categoriesAssigned:false,categories:[{maxNumberOfElements:4}]};var l=["ajaxSettings","template"];this.get=function(e){return o[e]};this.equals=function(f,e){if(n(f)){if(o[f]===e){return true}}return false};this.checkDataUrlProperties=function(){if(o.url==="list-required"&&o.data==="list-required"){return false}return true};this.checkRequiredProperties=function(){for(var e in o){if(o[e]==="required"){logger.error("Option "+e+" must be defined");return false}}return true};this.printPropertiesThatDoesntExist=function(f,e){b(f,e)};p();q();if(o.loggerEnabled===true){b(console,a)}m();r();function p(){if(a.dataType==="xml"){if(!a.getValue){a.getValue=function(j){return $(j).text()}}if(!a.list){a.list={}}if(!a.list.sort){a.list.sort={}}a.list.sort.method=function(j,k){j=a.getValue(j);k=a.getValue(k);if(j<k){return -1}if(j>k){return 1}return 0};if(!a.list.match){a.list.match={}}a.list.match.method=function(j,k){if(j.search(k)>-1){return true}else{return false}}}if(a.categories!==undefined&&a.categories instanceof Array){var f=[];for(var e=0,h=a.categories.length;e<h;e+=1){var i=a.categories[e];for(var g in o.categories[0]){if(i[g]===undefined){i[g]=o.categories[0][g]}}f.push(i)}a.categories=f}}function q(){o=e(o,a);function e(i,h){var g=i||{};for(var f in i){if(h[f]!==undefined&&h[f]!==null){if(typeof h[f]!=="object"||h[f] instanceof Array){g[f]=h[f]}else{e(i[f],h[f])}}}if(h.data!==undefined&&h.data!==null&&typeof h.data==="object"){g.data=h.data}return g}}function r(){if(o.url!=="list-required"&&typeof o.url!=="function"){var f=o.url;o.url=function(){return f}}if(o.ajaxSettings.url!==undefined&&typeof o.ajaxSettings.url!=="function"){var f=o.ajaxSettings.url;o.ajaxSettings.url=function(){return f}}if(typeof o.listLocation==="string"){var e=o.listLocation;if(o.dataType.toUpperCase()==="XML"){o.listLocation=function(h){return $(h).find(e)}}else{o.listLocation=function(h){return h[e]}}}if(typeof o.getValue==="string"){var g=o.getValue;o.getValue=function(h){return h[g]}}if(a.categories!==undefined){o.categoriesAssigned=true}}function m(){if(a.ajaxSettings!==undefined&&typeof a.ajaxSettings==="object"){o.ajaxSettings=a.ajaxSettings}else{o.ajaxSettings={}}}function n(e){if(o[e]!==undefined&&o[e]!==null){return true}else{return false}}function b(f,e){g(o,e);function g(i,h){for(var j in h){if(i[j]===undefined){f.log("Property '"+j+"' does not exist in EasyAutocomplete options API.")}if(typeof i[j]==="object"&&$.inArray(j,l)===-1){g(i[j],h[j])}}}}};return c})(EasyAutocomplete||{});var EasyAutocomplete=(function(c){c.Logger=function d(){this.error=function(a){console.log("ERROR: "+a)};this.warning=function(a){console.log("WARNING: "+a)}};return c})(EasyAutocomplete||{});var EasyAutocomplete=(function(d){d.Constans=function c(){var a={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"eac-container-",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(b){return a[b]}};return d})(EasyAutocomplete||{});var EasyAutocomplete=(function(c){c.ListBuilderService=function d(a,g){this.init=function(e){var f=[],j={};j.data=a.get("listLocation")(e);j.getValue=a.get("getValue");j.maxListSize=a.get("list").maxNumberOfElements;f.push(j);return f};this.updateCategories=function(i,e){if(a.get("categoriesAssigned")){i=[];for(var f=0;f<a.get("categories").length;f+=1){var l=h(a.get("categories")[f],e);i.push(l)}}return i};this.convertXml=function(f){if(a.get("dataType").toUpperCase()==="XML"){for(var e=0;e<f.length;e+=1){f[e].data=b(f[e])}}return f};this.processData=function(l,e){for(var i=0,f=l.length;i<f;i+=1){l[i].data=g(a,l[i],e)}return l};this.checkIfDataExists=function(i){for(var f=0,e=i.length;f<e;f+=1){if(i[f].data!==undefined&&i[f].data instanceof Array){if(i[f].data.length>0){return true}}}return false};function h(n,m){var o={};if(a.get("dataType").toUpperCase()==="XML"){o=f()}else{o=p()}if(n.header!==undefined){o.header=n.header}if(n.maxNumberOfElements!==undefined){o.maxNumberOfElements=n.maxNumberOfElements}if(a.get("list").maxNumberOfElements!==undefined){o.maxListSize=a.get("list").maxNumberOfElements}if(n.getValue!==undefined){if(typeof n.getValue==="string"){var e=n.getValue;o.getValue=function(i){return i[e]}}else{if(typeof n.getValue==="function"){o.getValue=n.getValue}}}else{o.getValue=a.get("getValue")}return o;function f(){var i={},j;if(n.xmlElementName!==undefined){i.xmlElementName=n.xmlElementName}if(n.listLocation!==undefined){j=n.listLocation}else{if(a.get("listLocation")!==undefined){j=a.get("listLocation")}}if(j!==undefined){if(typeof j==="string"){i.data=$(m).find(j)}else{if(typeof j==="function"){i.data=j(m)}}}else{i.data=m}return i}function p(){var i={};if(n.listLocation!==undefined){if(typeof n.listLocation==="string"){i.data=m[n.listLocation]}else{if(typeof n.listLocation==="function"){i.data=n.listLocation(m)}}}else{i.data=m}return i}}function b(f){var e=[];if(f.xmlElementName===undefined){f.xmlElementName=a.get("xmlElementName")}$(f.data).find(f.xmlElementName).each(function(){e.push(this)});return e}};return c})(EasyAutocomplete||{});var EasyAutocomplete=(function(d){d.proccess=function c(r,l,q){d.proccess.match=n;var m=l.data,o=q;m=a(m,o);m=b(m);m=p(m);return m;function a(h,f){var g=[],i="";if(r.get("list").match.enabled){for(var e=0,j=h.length;e<j;e+=1){i=r.get("getValue")(h[e]);if(n(i,f)){g.push(h[e])}}}else{g=h}return g}function n(e,f){if(!r.get("list").match.caseSensitive){if(typeof e==="string"){e=e.toLowerCase()}f=f.toLowerCase()}if(r.get("list").match.method(e,f)){return true}else{return false}}function b(e){if(l.maxNumberOfElements!==undefined&&e.length>l.maxNumberOfElements){e=e.slice(0,l.maxNumberOfElements)}return e}function p(e){if(r.get("list").sort.enabled){e.sort(r.get("list").sort.method)}return e}};return d})(EasyAutocomplete||{});var EasyAutocomplete=(function(d){d.Template=function c(j){var h={basic:{type:"basic",method:function(e){return e},cssClass:""},description:{type:"description",fields:{description:"description"},method:function(e){return e+" - description"},cssClass:"eac-description"},iconLeft:{type:"iconLeft",fields:{icon:""},method:function(e){return e},cssClass:"eac-icon-left"},iconRight:{type:"iconRight",fields:{iconSrc:""},method:function(e){return e},cssClass:"eac-icon-right"},links:{type:"links",fields:{link:""},method:function(e){return e},cssClass:""},custom:{type:"custom",method:function(){},cssClass:""}},i=function(e){var g=e.fields,f;if(e.type==="description"){f=h.description.method;if(typeof g.description==="string"){f=function(m,n){return m+" - <span>"+n[g.description]+"</span>"}}else{if(typeof g.description==="function"){f=function(m,n){return m+" - <span>"+g.description(n)+"</span>"}}}return f}if(e.type==="iconRight"){if(typeof g.iconSrc==="string"){f=function(m,n){return m+"<img class='eac-icon' src='"+n[g.iconSrc]+"' />"}}else{if(typeof g.iconSrc==="function"){f=function(m,n){return m+"<img class='eac-icon' src='"+g.iconSrc(n)+"' />"}}}return f}if(e.type==="iconLeft"){if(typeof g.iconSrc==="string"){f=function(m,n){return"<img class='eac-icon' src='"+n[g.iconSrc]+"' />"+m}}else{if(typeof g.iconSrc==="function"){f=function(m,n){return"<img class='eac-icon' src='"+g.iconSrc(n)+"' />"+m}}}return f}if(e.type==="links"){if(typeof g.link==="string"){f=function(m,n){return"<a href='"+n[g.link]+"' >"+m+"</a>"}}else{if(typeof g.link==="function"){f=function(m,n){return"<a href='"+g.link(n)+"' >"+m+"</a>"}}}return f}if(e.type==="custom"){return e.method}return h.basic.method},a=function(e){if(!e||!e.type){return h.basic.method}if(e.type&&h[e.type]){return i(e)}else{return h.basic.method}},b=function(f){var e=function(){return""};if(!f||!f.type){return e}if(f.type&&h[f.type]){return(function(){var g=h[f.type].cssClass;return function(){return g}})()}else{return e}};this.getTemplateClass=b(j);this.build=a(j)};return d})(EasyAutocomplete||{});var EasyAutocomplete=(function(d){d.main=function c(S,Q){var R={name:"EasyAutocomplete",shortcut:"eac"};var J=new d.Constans(),B=new d.Configuration(Q),b=new d.Logger(),A=new d.Template(Q.template),L=new d.ListBuilderService(B,d.proccess),C=B.equals,H=S,F="",a=[],E=-1,N;d.consts=J;this.getConstants=function(){return J};this.getConfiguration=function(){return B};this.getContainer=function(){return F};this.getSelectedItemIndex=function(){return E};this.getItems=function(){return a};this.getItemData=function(e){if(a.length<e||a[e]===undefined){return -1}else{return a[e]}};this.getSelectedItemData=function(){return this.getItemData(E)};this.build=function(){z()};this.init=function(){D()};function D(){if(H.length===0){b.error("Input field doesn't exist.");return}if(!B.checkDataUrlProperties()){b.error("One of options variables 'data' or 'url' must be defined.");return}if(!B.checkRequiredProperties()){b.error("Will not work without mentioned properties.");return}z();T()}function z(){if(H.parent().hasClass(J.getValue("WRAPPER_CSS_CLASS"))){f();g()}k();h();F=$("#"+O());if(B.get("placeholder")){H.attr("placeholder",B.get("placeholder"))}function k(){var m=$("<div>"),n=J.getValue("WRAPPER_CSS_CLASS");if(B.get("theme")&&B.get("theme")!==""){n+=" eac-"+B.get("theme")}if(B.get("cssClasses")&&B.get("cssClasses")!==""){n+=" "+B.get("cssClasses")}if(A.getTemplateClass()!==""){n+=" "+A.getTemplateClass()}m.addClass(n);H.wrap(m);if(B.get("adjustWidth")===true){j()}}function j(){var m=H.outerWidth();H.parent().css("width",m)}function g(){H.unwrap()}function h(){var m=$("<div>").addClass(J.getValue("CONTAINER_CLASS"));m.attr("id",O()).prepend($("<ul>"));(function(){m.on("show.eac",function(){switch(B.get("list").showAnimation.type){case"slide":var o=B.get("list").showAnimation.time,n=B.get("list").showAnimation.callback;m.find("ul").slideDown(o,n);break;case"fade":var o=B.get("list").showAnimation.time,n=B.get("list").showAnimation.callback;m.find("ul").fadeIn(o),n;break;default:m.find("ul").show();break}B.get("list").onShowListEvent()}).on("hide.eac",function(){switch(B.get("list").hideAnimation.type){case"slide":var o=B.get("list").hideAnimation.time,n=B.get("list").hideAnimation.callback;m.find("ul").slideUp(o,n);break;case"fade":var o=B.get("list").hideAnimation.time,n=B.get("list").hideAnimation.callback;m.find("ul").fadeOut(o,n);break;default:m.find("ul").hide();break}B.get("list").onHideListEvent()}).on("selectElement.eac",function(){m.find("ul li").removeClass("selected");m.find("ul li").eq(E).addClass("selected");B.get("list").onSelectItemEvent()}).on("loadElements.eac",function(v,u,t){var o="",r=m.find("ul");r.empty().detach();a=[];var w=0;for(var x=0,n=u.length;x<n;x+=1){var q=u[x].data;if(q.length===0){continue}if(u[x].header!==undefined&&u[x].header.length>0){r.append("<div class='eac-category' >"+u[x].header+"</div>")}for(var s=0,p=q.length;s<p&&w<u[x].maxListSize;s+=1){o=$("<li><div class='eac-item'></div></li>");(function(){var W=s,X=w,y=u[x].getValue(q[W]);o.find(" > div").on("click",function(){H.val(y).trigger("change");E=X;K(X);B.get("list").onClickEvent();B.get("list").onChooseEvent()}).mouseover(function(){E=X;K(X);B.get("list").onMouseOverEvent()}).mouseout(function(){B.get("list").onMouseOutEvent()}).html(A.build(l(y,t),q[W]))})();r.append(o);a.push(q[s]);w+=1}}m.append(r);B.get("list").onLoadEvent()})})();H.after(m)}function f(){H.next("."+J.getValue("CONTAINER_CLASS")).remove()}function l(m,n){if(B.get("highlightPhrase")&&n!==""){return i(m,n)}else{return m}}function e(m){return m.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function i(m,o){var n=e(o);return(m+"").replace(new RegExp("("+n+")","gi"),"<b>$1</b>")}}function O(){var e=H.attr("id");e=J.getValue("CONTAINER_ID")+e;return e}function T(){l();function l(){if(C("autocompleteOff",true)){h()}e();k();i();g();j();f()}function e(){H.focusout(function(){var m=H.val(),p;if(!B.get("list").match.caseSensitive){m=m.toLowerCase()}for(var o=0,n=a.length;o<n;o+=1){p=B.get("getValue")(a[o]);if(!B.get("list").match.caseSensitive){p=p.toLowerCase()}if(p===m){E=o;K(E);return}}})}function k(){H.off("keyup").keyup(function(m){switch(m.keyCode){case 27:G();P();break;case 38:m.preventDefault();if(a.length>0&&E>0){E-=1;H.val(B.get("getValue")(a[E]));K(E)}break;case 40:m.preventDefault();if(a.length>0&&E<a.length-1){E+=1;H.val(B.get("getValue")(a[E]));K(E)}break;default:if(m.keyCode>40||m.keyCode===8){var n=H.val();if(!(B.get("list").hideOnEmptyPhrase===true&&m.keyCode===8&&n==="")){if(B.get("requestDelay")>0){if(N!==undefined){clearTimeout(N)}N=setTimeout(function(){o(n)},B.get("requestDelay"))}else{o(n)}}else{G()}}break}function o(t){if(t.length<B.get("minCharNumber")){return}if(B.get("data")!=="list-required"){var s=B.get("data");var q=L.init(s);q=L.updateCategories(q,s);q=L.processData(q,t);I(q,t);if(H.parent().find("li").length>0){M()}else{G()}}var u=r();if(u.url===undefined||u.url===""){u.url=B.get("url")}if(u.dataType===undefined||u.dataType===""){u.dataType=B.get("dataType")}if(u.url!==undefined&&u.url!=="list-required"){u.url=u.url(t);u.data=B.get("preparePostData")(u.data,t);$.ajax(u).done(function(v){var w=L.init(v);w=L.updateCategories(w,v);w=L.convertXml(w);if(p(t,v)){w=L.processData(w,t);I(w,t)}if(L.checkIfDataExists(w)&&H.parent().find("li").length>0){M()}else{G()}B.get("ajaxCallback")()}).fail(function(){b.warning("Fail to load response data")}).always(function(){})}function r(){var x={},w=B.get("ajaxSettings")||{};for(var v in w){x[v]=w[v]}return x}function p(w,v){if(B.get("matchResponseProperty")!==false){if(typeof B.get("matchResponseProperty")==="string"){return(v[B.get("matchResponseProperty")]===w)}if(typeof B.get("matchResponseProperty")==="function"){return(B.get("matchResponseProperty")(v)===w)}return true}else{return true}}}})}function i(){H.on("keydown",function(n){n=n||window.event;var m=n.keyCode;if(m===38){suppressKeypress=true;return false}}).keydown(function(m){if(m.keyCode===13&&E>-1){H.val(B.get("getValue")(a[E]));B.get("list").onKeyEnterEvent();B.get("list").onChooseEvent();E=-1;G();m.preventDefault()}})}function g(){H.off("keypress")}function j(){H.focus(function(){if(H.val()!==""&&a.length>0){E=-1;M()}})}function f(){H.blur(function(){setTimeout(function(){E=-1;G()},250)})}function h(){H.attr("autocomplete","off")}}function M(){F.trigger("show.eac")}function G(){F.trigger("hide.eac")}function K(e){F.trigger("selectElement.eac",e)}function I(e,f){F.trigger("loadElements.eac",[e,f])}function P(){H.trigger("blur")}};d.eacHandles=[];d.getHandle=function(a){return d.eacHandles[a]};d.inputHasId=function(a){if($(a).attr("id")!==undefined&&$(a).attr("id").length>0){return true}else{return false}};d.assignRandomId=function(a){var b="";do{b="eac-"+Math.floor(Math.random()*10000)}while($("#"+b).length!==0);elementId=d.consts.getValue("CONTAINER_ID")+b;$(a).attr("id",b)};d.setHandle=function(b,a){d.eacHandles[a]=b};return d})(EasyAutocomplete||{});(function(b){b.fn.easyAutocomplete=function(a){return this.each(function(){var e=b(this),f=new EasyAutocomplete.main(e,a);if(!EasyAutocomplete.inputHasId(e)){EasyAutocomplete.assignRandomId(e)}f.init();EasyAutocomplete.setHandle(f,e.attr("id"))})};b.fn.getSelectedItemIndex=function(){var a=b(this).attr("id");if(a!==undefined){return EasyAutocomplete.getHandle(a).getSelectedItemIndex()}return -1};b.fn.getItems=function(){var a=b(this).attr("id");if(a!==undefined){return EasyAutocomplete.getHandle(a).getItems()}return -1};b.fn.getItemData=function(d){var a=b(this).attr("id");if(a!==undefined&&d>-1){return EasyAutocomplete.getHandle(a).getItemData(d)}return -1};b.fn.getSelectedItemData=function(){var a=b(this).attr("id");if(a!==undefined){return EasyAutocomplete.getHandle(a).getSelectedItemData()}return -1}})(jQuery);